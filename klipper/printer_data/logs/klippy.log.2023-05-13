===== Config file =====
[mcu]
restart_method = command
serial = /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00

[stepper_x]
step_pin = PC14
dir_pin = !PC13
enable_pin = !PC15
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
endstop_pin = PA14
position_min = 0
position_endstop = 230
position_max = 230
homing_speed = 50
homing_retract_dist = 5
homing_positive_dir = true
step_pulse_duration = 0.000008

[stepper_y]
step_pin = PE5
dir_pin = !PE4
enable_pin = !PD14
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
endstop_pin = PA15
position_min = 0
position_endstop = 230
position_max = 230
homing_speed = 50
homing_retract_dist = 5
homing_positive_dir = true
step_pulse_duration = 0.000008

[stepper_z]
step_pin = PE1
dir_pin = !PE0
enable_pin = !PE2
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16
endstop_pin = probe:z_virtual_endstop
position_max = 255
position_min = -5
homing_speed = 8
second_homing_speed = 3

[stepper_z1]
step_pin = PD6
dir_pin = PD5
enable_pin = !PD7
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[stepper_z2]
step_pin = PD2
dir_pin = PD1
enable_pin = !PD3
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[stepper_z3]
step_pin = PC7
dir_pin = PC6
enable_pin = !PC8
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[extruder]
step_pin = PB5
dir_pin = !PB4
enable_pin = !PB6
microsteps = 16
rotation_distance = 25.12
gear_ratio = 50:17
full_steps_per_rotation = 200
nozzle_diameter = 0.400
filament_diameter = 1.750
min_temp = 0
max_temp = 275
heater_pin = PB1
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = PC1
max_power = 1.0
control = pid
pid_kp = 26.213
pid_ki = 1.304
pid_kd = 131.721
pressure_advance = 0.00
pressure_advance_smooth_time = 0.150
max_extrude_cross_section = 20
instantaneous_corner_velocity = 1.000
max_extrude_only_distance = 50.0
max_extrude_only_velocity = 5000
max_extrude_only_accel = 2000
step_pulse_duration = 0.000004

[fan]
pin = PA2

[heater_fan fan1]
pin = PA1
shutdown_speed = 1

[heater_fan fan2]
pin = PA0
shutdown_speed = 1

[idle_timeout]
timeout = 3600

[safe_z_home]
home_xy_position = 115,115
speed = 100
z_hop = 10
z_hop_speed = 5

[quad_gantry_level]
gantry_corners = 
	-58,-7
	308,318
points = 
	10,10
	10,200
	220,200
	220,10
speed = 80
horizontal_move_z = 10
retries = 1
retry_tolerance = 0.05
max_adjust = 30

[probe]
pin = !PB15
x_offset = 0
y_offset = 25.0
z_offset = 0.55
speed = 10.0
samples = 2
samples_result = median
sample_retract_dist = 3.0
samples_tolerance = 0.05
samples_tolerance_retries = 1

[printer]
kinematics = corexy
max_velocity = 500
max_accel = 8000
max_accel_to_decel = 4000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 2.0

[tmc2209 stepper_x]
uart_pin = PE6
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[tmc2209 stepper_y]
uart_pin = PE3
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[tmc2209 stepper_z]
uart_pin = PB7
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 120

[tmc2209 stepper_z1]
uart_pin = PD4
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 stepper_z2]
uart_pin = PD0
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 stepper_z3]
uart_pin = PD15
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 extruder]
uart_pin = PB3
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[board_pins]
aliases = 
	
	EXP1_1=PB2,  EXP1_3=PE11, EXP1_5=PD9, EXP1_7=PE15, EXP1_9=<GND>,
	EXP1_2=PE10, EXP1_4=PD10, EXP1_6=PD8, EXP1_8=PE7,  EXP1_10=<5V>,
	
	EXP2_1=PA6, EXP2_3=PE9, EXP2_5=PE8, EXP2_7=PD13,  EXP2_9=<GND>,
	EXP2_2=PA5, EXP2_4=PA4, EXP2_6=PA7, EXP2_8=<RST>, EXP2_10=<3.3v>

[display]
lcd_type = uc1701
cs_pin = EXP1_3
a0_pin = EXP1_4
rst_pin = EXP1_5
contrast = 63
encoder_pins = ^EXP2_5, ^EXP2_3
click_pin = ^!EXP1_2
spi_software_miso_pin = EXP2_1
spi_software_mosi_pin = EXP2_6
spi_software_sclk_pin = EXP2_2

[output_pin beeper]
pin = EXP1_1

[neopixel fysetc_mini12864]
pin = EXP1_6
chain_count = 3
color_order = RGB
initial_red = 1.0
initial_green = 1.0
initial_blue = 0.0

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[resonance_tester]
accel_chip = adxl345
probe_points = 
	100, 100, 20

[input_shaper]
shaper_freq_x = 68.4
shaper_type_x = mzv
shaper_freq_y = 45.6
shaper_type_y = mzv

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE

[display_status]

[gcode_macro G32]
gcode = 
	BED_MESH_CLEAR
	G28
	QUAD_GANTRY_LEVEL
	G2888
=======================
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
webhooks client 281473534570680: {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
=============== Log rollover at Sat May 13 15:16:33 2023 ===============
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
MCU error during connect
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/mcu.py", line 798, in _mcu_identify
    self._serial.connect_uart(self._serialport, self._baud, rts)
  File "/home/mks/klipper/klippy/serialhdl.py", line 182, in connect_uart
    self._error("Unable to connect")
  File "/home/mks/klipper/klippy/serialhdl.py", line 61, in _error
    raise error(self.warn_prefix + (msg % params))
serialhdl.error: mcu 'mcu': Unable to connect

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 176, in _connect
    self.send_event("klippy:mcu_identify")
  File "/home/mks/klipper/klippy/klippy.py", line 263, in send_event
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/mks/klipper/klippy/klippy.py", line 263, in <listcomp>
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/mks/klipper/klippy/mcu.py", line 803, in _mcu_identify
    raise error(str(e))
mcu.error: mcu 'mcu': Unable to connect
Build file /home/mks/klipper/klippy/../.config(3223): Sun Mar  5 17:11:05 2023
========= Last MCU build config =========
CONFIG_LOW_LEVEL_OPTIONS=y
# CONFIG_MACH_AVR is not set
# CONFIG_MACH_ATSAM is not set
# CONFIG_MACH_ATSAMD is not set
# CONFIG_MACH_LPC176X is not set
CONFIG_MACH_STM32=y
# CONFIG_MACH_HC32F460 is not set
# CONFIG_MACH_RP2040 is not set
# CONFIG_MACH_PRU is not set
# CONFIG_MACH_AR100 is not set
# CONFIG_MACH_LINUX is not set
# CONFIG_MACH_SIMU is not set
CONFIG_BOARD_DIRECTORY="stm32"
CONFIG_MCU="stm32f407xx"
CONFIG_CLOCK_FREQ=168000000
CONFIG_USBSERIAL=y
CONFIG_FLASH_SIZE=0x80000
CONFIG_FLASH_BOOT_ADDRESS=0x8000000
CONFIG_RAM_START=0x20000000
CONFIG_RAM_SIZE=0x20000
CONFIG_STACK_SIZE=512
CONFIG_FLASH_APPLICATION_ADDRESS=0x800C000
CONFIG_STM32_SELECT=y
# CONFIG_MACH_STM32F103 is not set
# CONFIG_MACH_STM32F207 is not set
# CONFIG_MACH_STM32F401 is not set
# CONFIG_MACH_STM32F405 is not set
CONFIG_MACH_STM32F407=y
# CONFIG_MACH_STM32F429 is not set
# CONFIG_MACH_STM32F446 is not set
# CONFIG_MACH_STM32F031 is not set
# CONFIG_MACH_STM32F042 is not set
# CONFIG_MACH_STM32F070 is not set
# CONFIG_MACH_STM32F072 is not set
# CONFIG_MACH_STM32G070 is not set
# CONFIG_MACH_STM32G071 is not set
# CONFIG_MACH_STM32G0B0 is not set
# CONFIG_MACH_STM32G0B1 is not set
# CONFIG_MACH_STM32G431 is not set
# CONFIG_MACH_STM32H723 is not set
# CONFIG_MACH_STM32H743 is not set
# CONFIG_MACH_STM32H750 is not set
# CONFIG_MACH_STM32L412 is not set
CONFIG_MACH_STM32F4=y
CONFIG_MACH_STM32F4x5=y
CONFIG_HAVE_STM32_USBOTG=y
CONFIG_HAVE_STM32_CANBUS=y
CONFIG_HAVE_STM32_USBCANBUS=y
CONFIG_STM32_DFU_ROM_ADDRESS=0x1fff0000
# CONFIG_STM32_FLASH_START_8000 is not set
# CONFIG_STM32_FLASH_START_20200 is not set
CONFIG_STM32_FLASH_START_C000=y
# CONFIG_STM32_FLASH_START_4000 is not set
# CONFIG_STM32_FLASH_START_0000 is not set
CONFIG_STM32_CLOCK_REF_8M=y
# CONFIG_STM32_CLOCK_REF_12M is not set
# CONFIG_STM32_CLOCK_REF_16M is not set
# CONFIG_STM32_CLOCK_REF_20M is not set
# CONFIG_STM32_CLOCK_REF_25M is not set
# CONFIG_STM32_CLOCK_REF_INTERNAL is not set
CONFIG_CLOCK_REF_FREQ=8000000
CONFIG_STM32F0_TRIM=16
CONFIG_STM32_USB_PA11_PA12=y
# CONFIG_STM32_SERIAL_USART1 is not set
# CONFIG_STM32_SERIAL_USART1_ALT_PB7_PB6 is not set
# CONFIG_STM32_SERIAL_USART2 is not set
# CONFIG_STM32_SERIAL_USART2_ALT_PD6_PD5 is not set
# CONFIG_STM32_SERIAL_USART3 is not set
# CONFIG_STM32_SERIAL_USART3_ALT_PD9_PD8 is not set
# CONFIG_STM32_CANBUS_PA11_PA12 is not set
# CONFIG_STM32_CANBUS_PA11_PB9 is not set
# CONFIG_STM32_MMENU_CANBUS_PB8_PB9 is not set
# CONFIG_STM32_MMENU_CANBUS_PI9_PH13 is not set
# CONFIG_STM32_MMENU_CANBUS_PB5_PB6 is not set
# CONFIG_STM32_MMENU_CANBUS_PB12_PB13 is not set
# CONFIG_STM32_MMENU_CANBUS_PD0_PD1 is not set
# CONFIG_STM32_USBCANBUS_PA11_PA12 is not set
CONFIG_USB=y
CONFIG_USB_VENDOR_ID=0x1d50
CONFIG_USB_DEVICE_ID=0x614e
CONFIG_USB_SERIAL_NUMBER_CHIPID=y
CONFIG_USB_SERIAL_NUMBER="12345"

#
# USB ids
#
# end of USB ids

CONFIG_CANBUS_FREQUENCY=500000
CONFIG_INITIAL_PINS=""
CONFIG_HAVE_GPIO=y
CONFIG_HAVE_GPIO_ADC=y
CONFIG_HAVE_GPIO_SPI=y
CONFIG_HAVE_GPIO_SDIO=y
CONFIG_HAVE_GPIO_I2C=y
CONFIG_HAVE_GPIO_HARD_PWM=y
CONFIG_HAVE_GPIO_BITBANGING=y
CONFIG_HAVE_STRICT_TIMING=y
CONFIG_HAVE_CHIPID=y
CONFIG_HAVE_STEPPER_BOTH_EDGE=y
CONFIG_HAVE_BOOTLOADER_REQUEST=y
CONFIG_INLINE_STEPPER_HACK=y
=======================
Build file /home/mks/klipper/klippy/../out/klipper.dict(8495): Sun Mar  5 17:11:35 2023
Last MCU build version: ?-20230305_171135-mkspi
Last MCU build tools: gcc: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] binutils: (2.31.1-12+11) 2.31.1
Last MCU build config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_i2c2a=PH4,PH5 BUS_PINS_i2c3=PA8,PC9 BUS_PINS_i2c3a=PH7,PH8 BUS_PINS_sdio=PC12,PD2,PC8,PC9,PC10,PC11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi2b=PI2,PI3,PI1 BUS_PINS_spi3=PB4,PB5,PB3 BUS_PINS_spi3a=PC11,PC12,PC10 CLOCK_FREQ=168000000 MCU=stm32f407xx PWM_MAX=255 RESERVE_PINS_USB=PA11,PA12 RESERVE_PINS_crystal=PH0,PH1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Build file /home/mks/klipper/klippy/../out/klipper.elf(377440): Sun Mar  5 17:11:46 2023
Starting Klippy...
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
Start printer at Sat May 13 15:26:55 2023 (1683962815.4 25.5)
===== Config file =====
[mcu]
restart_method = command
serial = /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00

[stepper_x]
step_pin = PC14
dir_pin = !PC13
enable_pin = !PC15
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
endstop_pin = PA14
position_min = 0
position_endstop = 230
position_max = 230
homing_speed = 50
homing_retract_dist = 5
homing_positive_dir = true
step_pulse_duration = 0.000008

[stepper_y]
step_pin = PE5
dir_pin = !PE4
enable_pin = !PD14
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
endstop_pin = PA15
position_min = 0
position_endstop = 230
position_max = 230
homing_speed = 50
homing_retract_dist = 5
homing_positive_dir = true
step_pulse_duration = 0.000008

[stepper_z]
step_pin = PE1
dir_pin = !PE0
enable_pin = !PE2
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16
endstop_pin = probe:z_virtual_endstop
position_max = 255
position_min = -5
homing_speed = 8
second_homing_speed = 3

[stepper_z1]
step_pin = PD6
dir_pin = PD5
enable_pin = !PD7
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[stepper_z2]
step_pin = PD2
dir_pin = PD1
enable_pin = !PD3
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[stepper_z3]
step_pin = PC7
dir_pin = PC6
enable_pin = !PC8
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[extruder]
step_pin = PB5
dir_pin = !PB4
enable_pin = !PB6
microsteps = 16
rotation_distance = 25.12
gear_ratio = 50:17
full_steps_per_rotation = 200
nozzle_diameter = 0.400
filament_diameter = 1.750
min_temp = 0
max_temp = 275
heater_pin = PB1
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = PC1
max_power = 1.0
control = pid
pid_kp = 26.213
pid_ki = 1.304
pid_kd = 131.721
pressure_advance = 0.00
pressure_advance_smooth_time = 0.150
max_extrude_cross_section = 20
instantaneous_corner_velocity = 1.000
max_extrude_only_distance = 50.0
max_extrude_only_velocity = 5000
max_extrude_only_accel = 2000
step_pulse_duration = 0.000004

[fan]
pin = PA2

[heater_fan fan1]
pin = PA1
shutdown_speed = 1

[heater_fan fan2]
pin = PA0
shutdown_speed = 1

[idle_timeout]
timeout = 3600

[safe_z_home]
home_xy_position = 115,115
speed = 100
z_hop = 10
z_hop_speed = 5

[quad_gantry_level]
gantry_corners = 
	-58,-7
	308,318
points = 
	10,10
	10,200
	220,200
	220,10
speed = 80
horizontal_move_z = 10
retries = 1
retry_tolerance = 0.05
max_adjust = 30

[probe]
pin = !PB15
x_offset = 0
y_offset = 25.0
z_offset = 0.55
speed = 10.0
samples = 2
samples_result = median
sample_retract_dist = 3.0
samples_tolerance = 0.05
samples_tolerance_retries = 1

[printer]
kinematics = corexy
max_velocity = 500
max_accel = 8000
max_accel_to_decel = 4000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 2.0

[tmc2209 stepper_x]
uart_pin = PE6
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[tmc2209 stepper_y]
uart_pin = PE3
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[tmc2209 stepper_z]
uart_pin = PB7
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 120

[tmc2209 stepper_z1]
uart_pin = PD4
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 stepper_z2]
uart_pin = PD0
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 stepper_z3]
uart_pin = PD15
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 extruder]
uart_pin = PB3
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[board_pins]
aliases = 
	
	EXP1_1=PB2,  EXP1_3=PE11, EXP1_5=PD9, EXP1_7=PE15, EXP1_9=<GND>,
	EXP1_2=PE10, EXP1_4=PD10, EXP1_6=PD8, EXP1_8=PE7,  EXP1_10=<5V>,
	
	EXP2_1=PA6, EXP2_3=PE9, EXP2_5=PE8, EXP2_7=PD13,  EXP2_9=<GND>,
	EXP2_2=PA5, EXP2_4=PA4, EXP2_6=PA7, EXP2_8=<RST>, EXP2_10=<3.3v>

[display]
lcd_type = uc1701
cs_pin = EXP1_3
a0_pin = EXP1_4
rst_pin = EXP1_5
contrast = 63
encoder_pins = ^EXP2_5, ^EXP2_3
click_pin = ^!EXP1_2
spi_software_miso_pin = EXP2_1
spi_software_mosi_pin = EXP2_6
spi_software_sclk_pin = EXP2_2

[output_pin beeper]
pin = EXP1_1

[neopixel fysetc_mini12864]
pin = EXP1_6
chain_count = 3
color_order = RGB
initial_red = 1.0
initial_green = 1.0
initial_blue = 0.0

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[resonance_tester]
accel_chip = adxl345
probe_points = 
	100, 100, 20

[input_shaper]
shaper_freq_x = 68.4
shaper_type_x = mzv
shaper_freq_y = 45.6
shaper_type_y = mzv

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE

[display_status]

[gcode_macro G32]
gcode = 
	BED_MESH_CLEAR
	G28
	QUAD_GANTRY_LEVEL
	G2888
=======================
Extruder max_extrude_ratio=8.315034
mcu 'mcu': Starting serial connect
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
webhooks client 281473021271512: New connection
webhooks client 281473021271512: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
MCU error during connect
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/mcu.py", line 798, in _mcu_identify
    self._serial.connect_uart(self._serialport, self._baud, rts)
  File "/home/mks/klipper/klippy/serialhdl.py", line 182, in connect_uart
    self._error("Unable to connect")
  File "/home/mks/klipper/klippy/serialhdl.py", line 61, in _error
    raise error(self.warn_prefix + (msg % params))
serialhdl.error: mcu 'mcu': Unable to connect

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 176, in _connect
    self.send_event("klippy:mcu_identify")
  File "/home/mks/klipper/klippy/klippy.py", line 263, in send_event
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/mks/klipper/klippy/klippy.py", line 263, in <listcomp>
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/mks/klipper/klippy/mcu.py", line 803, in _mcu_identify
    raise error(str(e))
mcu.error: mcu 'mcu': Unable to connect
Build file /home/mks/klipper/klippy/../.config(3223): Sun Mar  5 17:11:05 2023
========= Last MCU build config =========
CONFIG_LOW_LEVEL_OPTIONS=y
# CONFIG_MACH_AVR is not set
# CONFIG_MACH_ATSAM is not set
# CONFIG_MACH_ATSAMD is not set
# CONFIG_MACH_LPC176X is not set
CONFIG_MACH_STM32=y
# CONFIG_MACH_HC32F460 is not set
# CONFIG_MACH_RP2040 is not set
# CONFIG_MACH_PRU is not set
# CONFIG_MACH_AR100 is not set
# CONFIG_MACH_LINUX is not set
# CONFIG_MACH_SIMU is not set
CONFIG_BOARD_DIRECTORY="stm32"
CONFIG_MCU="stm32f407xx"
CONFIG_CLOCK_FREQ=168000000
CONFIG_USBSERIAL=y
CONFIG_FLASH_SIZE=0x80000
CONFIG_FLASH_BOOT_ADDRESS=0x8000000
CONFIG_RAM_START=0x20000000
CONFIG_RAM_SIZE=0x20000
CONFIG_STACK_SIZE=512
CONFIG_FLASH_APPLICATION_ADDRESS=0x800C000
CONFIG_STM32_SELECT=y
# CONFIG_MACH_STM32F103 is not set
# CONFIG_MACH_STM32F207 is not set
# CONFIG_MACH_STM32F401 is not set
# CONFIG_MACH_STM32F405 is not set
CONFIG_MACH_STM32F407=y
# CONFIG_MACH_STM32F429 is not set
# CONFIG_MACH_STM32F446 is not set
# CONFIG_MACH_STM32F031 is not set
# CONFIG_MACH_STM32F042 is not set
# CONFIG_MACH_STM32F070 is not set
# CONFIG_MACH_STM32F072 is not set
# CONFIG_MACH_STM32G070 is not set
# CONFIG_MACH_STM32G071 is not set
# CONFIG_MACH_STM32G0B0 is not set
# CONFIG_MACH_STM32G0B1 is not set
# CONFIG_MACH_STM32G431 is not set
# CONFIG_MACH_STM32H723 is not set
# CONFIG_MACH_STM32H743 is not set
# CONFIG_MACH_STM32H750 is not set
# CONFIG_MACH_STM32L412 is not set
CONFIG_MACH_STM32F4=y
CONFIG_MACH_STM32F4x5=y
CONFIG_HAVE_STM32_USBOTG=y
CONFIG_HAVE_STM32_CANBUS=y
CONFIG_HAVE_STM32_USBCANBUS=y
CONFIG_STM32_DFU_ROM_ADDRESS=0x1fff0000
# CONFIG_STM32_FLASH_START_8000 is not set
# CONFIG_STM32_FLASH_START_20200 is not set
CONFIG_STM32_FLASH_START_C000=y
# CONFIG_STM32_FLASH_START_4000 is not set
# CONFIG_STM32_FLASH_START_0000 is not set
CONFIG_STM32_CLOCK_REF_8M=y
# CONFIG_STM32_CLOCK_REF_12M is not set
# CONFIG_STM32_CLOCK_REF_16M is not set
# CONFIG_STM32_CLOCK_REF_20M is not set
# CONFIG_STM32_CLOCK_REF_25M is not set
# CONFIG_STM32_CLOCK_REF_INTERNAL is not set
CONFIG_CLOCK_REF_FREQ=8000000
CONFIG_STM32F0_TRIM=16
CONFIG_STM32_USB_PA11_PA12=y
# CONFIG_STM32_SERIAL_USART1 is not set
# CONFIG_STM32_SERIAL_USART1_ALT_PB7_PB6 is not set
# CONFIG_STM32_SERIAL_USART2 is not set
# CONFIG_STM32_SERIAL_USART2_ALT_PD6_PD5 is not set
# CONFIG_STM32_SERIAL_USART3 is not set
# CONFIG_STM32_SERIAL_USART3_ALT_PD9_PD8 is not set
# CONFIG_STM32_CANBUS_PA11_PA12 is not set
# CONFIG_STM32_CANBUS_PA11_PB9 is not set
# CONFIG_STM32_MMENU_CANBUS_PB8_PB9 is not set
# CONFIG_STM32_MMENU_CANBUS_PI9_PH13 is not set
# CONFIG_STM32_MMENU_CANBUS_PB5_PB6 is not set
# CONFIG_STM32_MMENU_CANBUS_PB12_PB13 is not set
# CONFIG_STM32_MMENU_CANBUS_PD0_PD1 is not set
# CONFIG_STM32_USBCANBUS_PA11_PA12 is not set
CONFIG_USB=y
CONFIG_USB_VENDOR_ID=0x1d50
CONFIG_USB_DEVICE_ID=0x614e
CONFIG_USB_SERIAL_NUMBER_CHIPID=y
CONFIG_USB_SERIAL_NUMBER="12345"

#
# USB ids
#
# end of USB ids

CONFIG_CANBUS_FREQUENCY=500000
CONFIG_INITIAL_PINS=""
CONFIG_HAVE_GPIO=y
CONFIG_HAVE_GPIO_ADC=y
CONFIG_HAVE_GPIO_SPI=y
CONFIG_HAVE_GPIO_SDIO=y
CONFIG_HAVE_GPIO_I2C=y
CONFIG_HAVE_GPIO_HARD_PWM=y
CONFIG_HAVE_GPIO_BITBANGING=y
CONFIG_HAVE_STRICT_TIMING=y
CONFIG_HAVE_CHIPID=y
CONFIG_HAVE_STEPPER_BOTH_EDGE=y
CONFIG_HAVE_BOOTLOADER_REQUEST=y
CONFIG_INLINE_STEPPER_HACK=y
=======================
Build file /home/mks/klipper/klippy/../out/klipper.dict(8495): Sun Mar  5 17:11:35 2023
Last MCU build version: ?-20230305_171135-mkspi
Last MCU build tools: gcc: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] binutils: (2.31.1-12+11) 2.31.1
Last MCU build config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_i2c2a=PH4,PH5 BUS_PINS_i2c3=PA8,PC9 BUS_PINS_i2c3a=PH7,PH8 BUS_PINS_sdio=PC12,PD2,PC8,PC9,PC10,PC11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi2b=PI2,PI3,PI1 BUS_PINS_spi3=PB4,PB5,PB3 BUS_PINS_spi3a=PC11,PC12,PC10 CLOCK_FREQ=168000000 MCU=stm32f407xx PWM_MAX=255 RESERVE_PINS_USB=PA11,PA12 RESERVE_PINS_crystal=PH0,PH1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Build file /home/mks/klipper/klippy/../out/klipper.elf(377440): Sun Mar  5 17:11:46 2023
Starting Klippy...
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
Start printer at Sat May 13 15:34:01 2023 (1683963241.6 25.2)
===== Config file =====
[mcu]
restart_method = command
serial = /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00

[stepper_x]
step_pin = PC14
dir_pin = !PC13
enable_pin = !PC15
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
endstop_pin = PA14
position_min = 0
position_endstop = 230
position_max = 230
homing_speed = 50
homing_retract_dist = 5
homing_positive_dir = true
step_pulse_duration = 0.000008

[stepper_y]
step_pin = PE5
dir_pin = !PE4
enable_pin = !PD14
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
endstop_pin = PA15
position_min = 0
position_endstop = 230
position_max = 230
homing_speed = 50
homing_retract_dist = 5
homing_positive_dir = true
step_pulse_duration = 0.000008

[stepper_z]
step_pin = PE1
dir_pin = !PE0
enable_pin = !PE2
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16
endstop_pin = probe:z_virtual_endstop
position_max = 255
position_min = -5
homing_speed = 8
second_homing_speed = 3

[stepper_z1]
step_pin = PD6
dir_pin = PD5
enable_pin = !PD7
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[stepper_z2]
step_pin = PD2
dir_pin = PD1
enable_pin = !PD3
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[stepper_z3]
step_pin = PC7
dir_pin = PC6
enable_pin = !PC8
microsteps = 16
rotation_distance = 40
full_steps_per_rotation = 200
gear_ratio = 80:16

[extruder]
step_pin = PB5
dir_pin = !PB4
enable_pin = !PB6
microsteps = 16
rotation_distance = 25.12
gear_ratio = 50:17
full_steps_per_rotation = 200
nozzle_diameter = 0.400
filament_diameter = 1.750
min_temp = 0
max_temp = 275
heater_pin = PB1
sensor_type = NTC 100K MGB18-104F39050L32
sensor_pin = PC1
max_power = 1.0
control = pid
pid_kp = 26.213
pid_ki = 1.304
pid_kd = 131.721
pressure_advance = 0.00
pressure_advance_smooth_time = 0.150
max_extrude_cross_section = 20
instantaneous_corner_velocity = 1.000
max_extrude_only_distance = 50.0
max_extrude_only_velocity = 5000
max_extrude_only_accel = 2000
step_pulse_duration = 0.000004

[fan]
pin = PA2

[heater_fan fan1]
pin = PA1
shutdown_speed = 1

[heater_fan fan2]
pin = PA0
shutdown_speed = 1

[idle_timeout]
timeout = 3600

[safe_z_home]
home_xy_position = 115,115
speed = 100
z_hop = 10
z_hop_speed = 5

[quad_gantry_level]
gantry_corners = 
	-58,-7
	308,318
points = 
	10,10
	10,200
	220,200
	220,10
speed = 80
horizontal_move_z = 10
retries = 1
retry_tolerance = 0.05
max_adjust = 30

[probe]
pin = !PB15
x_offset = 0
y_offset = 25.0
z_offset = 0.55
speed = 10.0
samples = 2
samples_result = median
sample_retract_dist = 3.0
samples_tolerance = 0.05
samples_tolerance_retries = 1

[printer]
kinematics = corexy
max_velocity = 500
max_accel = 8000
max_accel_to_decel = 4000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 2.0

[tmc2209 stepper_x]
uart_pin = PE6
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[tmc2209 stepper_y]
uart_pin = PE3
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[tmc2209 stepper_z]
uart_pin = PB7
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 120

[tmc2209 stepper_z1]
uart_pin = PD4
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 stepper_z2]
uart_pin = PD0
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 stepper_z3]
uart_pin = PD15
interpolate = True
run_current = 0.8
hold_current = 0.5
stealthchop_threshold = 120

[tmc2209 extruder]
uart_pin = PB3
run_current = 0.8
hold_current = 0.5
interpolate = True
stealthchop_threshold = 400

[board_pins]
aliases = 
	
	EXP1_1=PB2,  EXP1_3=PE11, EXP1_5=PD9, EXP1_7=PE15, EXP1_9=<GND>,
	EXP1_2=PE10, EXP1_4=PD10, EXP1_6=PD8, EXP1_8=PE7,  EXP1_10=<5V>,
	
	EXP2_1=PA6, EXP2_3=PE9, EXP2_5=PE8, EXP2_7=PD13,  EXP2_9=<GND>,
	EXP2_2=PA5, EXP2_4=PA4, EXP2_6=PA7, EXP2_8=<RST>, EXP2_10=<3.3v>

[display]
lcd_type = uc1701
cs_pin = EXP1_3
a0_pin = EXP1_4
rst_pin = EXP1_5
contrast = 63
encoder_pins = ^EXP2_5, ^EXP2_3
click_pin = ^!EXP1_2
spi_software_miso_pin = EXP2_1
spi_software_mosi_pin = EXP2_6
spi_software_sclk_pin = EXP2_2

[output_pin beeper]
pin = EXP1_1

[neopixel fysetc_mini12864]
pin = EXP1_6
chain_count = 3
color_order = RGB
initial_red = 1.0
initial_green = 1.0
initial_blue = 0.0

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[resonance_tester]
accel_chip = adxl345
probe_points = 
	100, 100, 20

[input_shaper]
shaper_freq_x = 68.4
shaper_type_x = mzv
shaper_freq_y = 45.6
shaper_type_y = mzv

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE

[display_status]

[gcode_macro G32]
gcode = 
	BED_MESH_CLEAR
	G28
	QUAD_GANTRY_LEVEL
	G2888
=======================
Extruder max_extrude_ratio=8.315034
mcu 'mcu': Starting serial connect
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
webhooks client 281472954036408: New connection
webhooks client 281472954036408: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-Klipper_stm32f407xx_2C003B001250314335393520-if00'
MCU error during connect
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/mcu.py", line 798, in _mcu_identify
    self._serial.connect_uart(self._serialport, self._baud, rts)
  File "/home/mks/klipper/klippy/serialhdl.py", line 182, in connect_uart
    self._error("Unable to connect")
  File "/home/mks/klipper/klippy/serialhdl.py", line 61, in _error
    raise error(self.warn_prefix + (msg % params))
serialhdl.error: mcu 'mcu': Unable to connect

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 176, in _connect
    self.send_event("klippy:mcu_identify")
  File "/home/mks/klipper/klippy/klippy.py", line 263, in send_event
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/mks/klipper/klippy/klippy.py", line 263, in <listcomp>
    return [cb(*params) for cb in self.event_handlers.get(event, [])]
  File "/home/mks/klipper/klippy/mcu.py", line 803, in _mcu_identify
    raise error(str(e))
mcu.error: mcu 'mcu': Unable to connect
Build file /home/mks/klipper/klippy/../.config(3223): Sun Mar  5 17:11:05 2023
========= Last MCU build config =========
CONFIG_LOW_LEVEL_OPTIONS=y
# CONFIG_MACH_AVR is not set
# CONFIG_MACH_ATSAM is not set
# CONFIG_MACH_ATSAMD is not set
# CONFIG_MACH_LPC176X is not set
CONFIG_MACH_STM32=y
# CONFIG_MACH_HC32F460 is not set
# CONFIG_MACH_RP2040 is not set
# CONFIG_MACH_PRU is not set
# CONFIG_MACH_AR100 is not set
# CONFIG_MACH_LINUX is not set
# CONFIG_MACH_SIMU is not set
CONFIG_BOARD_DIRECTORY="stm32"
CONFIG_MCU="stm32f407xx"
CONFIG_CLOCK_FREQ=168000000
CONFIG_USBSERIAL=y
CONFIG_FLASH_SIZE=0x80000
CONFIG_FLASH_BOOT_ADDRESS=0x8000000
CONFIG_RAM_START=0x20000000
CONFIG_RAM_SIZE=0x20000
CONFIG_STACK_SIZE=512
CONFIG_FLASH_APPLICATION_ADDRESS=0x800C000
CONFIG_STM32_SELECT=y
# CONFIG_MACH_STM32F103 is not set
# CONFIG_MACH_STM32F207 is not set
# CONFIG_MACH_STM32F401 is not set
# CONFIG_MACH_STM32F405 is not set
CONFIG_MACH_STM32F407=y
# CONFIG_MACH_STM32F429 is not set
# CONFIG_MACH_STM32F446 is not set
# CONFIG_MACH_STM32F031 is not set
# CONFIG_MACH_STM32F042 is not set
# CONFIG_MACH_STM32F070 is not set
# CONFIG_MACH_STM32F072 is not set
# CONFIG_MACH_STM32G070 is not set
# CONFIG_MACH_STM32G071 is not set
# CONFIG_MACH_STM32G0B0 is not set
# CONFIG_MACH_STM32G0B1 is not set
# CONFIG_MACH_STM32G431 is not set
# CONFIG_MACH_STM32H723 is not set
# CONFIG_MACH_STM32H743 is not set
# CONFIG_MACH_STM32H750 is not set
# CONFIG_MACH_STM32L412 is not set
CONFIG_MACH_STM32F4=y
CONFIG_MACH_STM32F4x5=y
CONFIG_HAVE_STM32_USBOTG=y
CONFIG_HAVE_STM32_CANBUS=y
CONFIG_HAVE_STM32_USBCANBUS=y
CONFIG_STM32_DFU_ROM_ADDRESS=0x1fff0000
# CONFIG_STM32_FLASH_START_8000 is not set
# CONFIG_STM32_FLASH_START_20200 is not set
CONFIG_STM32_FLASH_START_C000=y
# CONFIG_STM32_FLASH_START_4000 is not set
# CONFIG_STM32_FLASH_START_0000 is not set
CONFIG_STM32_CLOCK_REF_8M=y
# CONFIG_STM32_CLOCK_REF_12M is not set
# CONFIG_STM32_CLOCK_REF_16M is not set
# CONFIG_STM32_CLOCK_REF_20M is not set
# CONFIG_STM32_CLOCK_REF_25M is not set
# CONFIG_STM32_CLOCK_REF_INTERNAL is not set
CONFIG_CLOCK_REF_FREQ=8000000
CONFIG_STM32F0_TRIM=16
CONFIG_STM32_USB_PA11_PA12=y
# CONFIG_STM32_SERIAL_USART1 is not set
# CONFIG_STM32_SERIAL_USART1_ALT_PB7_PB6 is not set
# CONFIG_STM32_SERIAL_USART2 is not set
# CONFIG_STM32_SERIAL_USART2_ALT_PD6_PD5 is not set
# CONFIG_STM32_SERIAL_USART3 is not set
# CONFIG_STM32_SERIAL_USART3_ALT_PD9_PD8 is not set
# CONFIG_STM32_CANBUS_PA11_PA12 is not set
# CONFIG_STM32_CANBUS_PA11_PB9 is not set
# CONFIG_STM32_MMENU_CANBUS_PB8_PB9 is not set
# CONFIG_STM32_MMENU_CANBUS_PI9_PH13 is not set
# CONFIG_STM32_MMENU_CANBUS_PB5_PB6 is not set
# CONFIG_STM32_MMENU_CANBUS_PB12_PB13 is not set
# CONFIG_STM32_MMENU_CANBUS_PD0_PD1 is not set
# CONFIG_STM32_USBCANBUS_PA11_PA12 is not set
CONFIG_USB=y
CONFIG_USB_VENDOR_ID=0x1d50
CONFIG_USB_DEVICE_ID=0x614e
CONFIG_USB_SERIAL_NUMBER_CHIPID=y
CONFIG_USB_SERIAL_NUMBER="12345"

#
# USB ids
#
# end of USB ids

CONFIG_CANBUS_FREQUENCY=500000
CONFIG_INITIAL_PINS=""
CONFIG_HAVE_GPIO=y
CONFIG_HAVE_GPIO_ADC=y
CONFIG_HAVE_GPIO_SPI=y
CONFIG_HAVE_GPIO_SDIO=y
CONFIG_HAVE_GPIO_I2C=y
CONFIG_HAVE_GPIO_HARD_PWM=y
CONFIG_HAVE_GPIO_BITBANGING=y
CONFIG_HAVE_STRICT_TIMING=y
CONFIG_HAVE_CHIPID=y
CONFIG_HAVE_STEPPER_BOTH_EDGE=y
CONFIG_HAVE_BOOTLOADER_REQUEST=y
CONFIG_INLINE_STEPPER_HACK=y
=======================
Build file /home/mks/klipper/klippy/../out/klipper.dict(8495): Sun Mar  5 17:11:35 2023
Last MCU build version: ?-20230305_171135-mkspi
Last MCU build tools: gcc: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] binutils: (2.31.1-12+11) 2.31.1
Last MCU build config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PB8,PB9 BUS_PINS_i2c2=PB10,PB11 BUS_PINS_i2c2a=PH4,PH5 BUS_PINS_i2c3=PA8,PC9 BUS_PINS_i2c3a=PH7,PH8 BUS_PINS_sdio=PC12,PD2,PC8,PC9,PC10,PC11 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi2b=PI2,PI3,PI1 BUS_PINS_spi3=PB4,PB5,PB3 BUS_PINS_spi3a=PC11,PC12,PC10 CLOCK_FREQ=168000000 MCU=stm32f407xx PWM_MAX=255 RESERVE_PINS_USB=PA11,PA12 RESERVE_PINS_crystal=PH0,PH1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Build file /home/mks/klipper/klippy/../out/klipper.elf(377440): Sun Mar  5 17:11:46 2023
Unable to issue reset command on MCU 'mcu'
Unable to issue reset command on MCU 'rpi'
webhooks client 281472954036408: Disconnected
Restarting printer
Start printer at Sat May 13 15:36:18 2023 (1683963378.4 143.4)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	M84 X Y E
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 X5 Y5 F3000
	G1 Z1
	G90
	
	G1 X10 Y210
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 220
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 120
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 237
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 2.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	188, 135
points = -16, 135
	188, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,7
mesh_max = 215,217
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4

[bed_mesh default]
version = 1
x_count = 5
y_count = 5
mesh_x_pps = 4
mesh_y_pps = 4
algo = bicubic
tension = 0.3
min_x = 7.0
max_x = 210.0
min_y = 5.0
max_y = 220.0
=======================
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 141, in _read_config
    self.load_object(config, section_config.get_name(), None)
  File "/home/mks/klipper/klippy/klippy.py", line 130, in load_object
    self.objects[section] = init_func(config.getsection(section))
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1244, in load_config
    return BedMesh(config)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 109, in __init__
    self.pmgr = ProfileManager(config, self)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1124, in __init__
    zvals = profile.getlists('points', seps=(',', '\n'), parser=float)
  File "/home/mks/klipper/klippy/configfile.py", line 99, in getlists
    note_valid=note_valid)
  File "/home/mks/klipper/klippy/configfile.py", line 33, in _get_wrapper
    % (option, self.section))
configparser.Error: Option 'points' in section 'bed_mesh default' must be specified
webhooks client 281472954430688: New connection
webhooks client 281472954430688: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
webhooks client 281472954430688: Disconnected
Restarting printer
Start printer at Sat May 13 15:43:15 2023 (1683963795.3 560.3)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	M84 X Y E
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 X5 Y5 F3000
	G1 Z1
	G90
	
	G1 X10 Y210
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 220
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 120
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 237
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 2.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	188, 135
points = -16, 135
	188, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,7
mesh_max = 215,217
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4

[bed_mesh default]
version = 1
x_count = 5
y_count = 5
mesh_x_pps = 4
mesh_y_pps = 4
algo = bicubic
tension = 0.3
min_x = 7.0
max_x = 210.0
min_y = 5.0
max_y = 220.0
=======================
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 141, in _read_config
    self.load_object(config, section_config.get_name(), None)
  File "/home/mks/klipper/klippy/klippy.py", line 130, in load_object
    self.objects[section] = init_func(config.getsection(section))
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1244, in load_config
    return BedMesh(config)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 109, in __init__
    self.pmgr = ProfileManager(config, self)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1124, in __init__
    zvals = profile.getlists('points', seps=(',', '\n'), parser=float)
  File "/home/mks/klipper/klippy/configfile.py", line 99, in getlists
    note_valid=note_valid)
  File "/home/mks/klipper/klippy/configfile.py", line 33, in _get_wrapper
    % (option, self.section))
configparser.Error: Option 'points' in section 'bed_mesh default' must be specified
webhooks client 281472954882480: New connection
webhooks client 281472954882480: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
Unable to issue reset command on MCU 'mcu'
Unable to issue reset command on MCU 'rpi'
webhooks client 281472954882480: Disconnected
Restarting printer
Start printer at Sat May 13 15:43:17 2023 (1683963797.9 562.9)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	M84 X Y E
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 X5 Y5 F3000
	G1 Z1
	G90
	
	G1 X10 Y210
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 220
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 120
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 237
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 2.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	188, 135
points = -16, 135
	188, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,7
mesh_max = 215,217
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4

[bed_mesh default]
version = 1
x_count = 5
y_count = 5
mesh_x_pps = 4
mesh_y_pps = 4
algo = bicubic
tension = 0.3
min_x = 7.0
max_x = 210.0
min_y = 5.0
max_y = 220.0
=======================
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 141, in _read_config
    self.load_object(config, section_config.get_name(), None)
  File "/home/mks/klipper/klippy/klippy.py", line 130, in load_object
    self.objects[section] = init_func(config.getsection(section))
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1244, in load_config
    return BedMesh(config)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 109, in __init__
    self.pmgr = ProfileManager(config, self)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1124, in __init__
    zvals = profile.getlists('points', seps=(',', '\n'), parser=float)
  File "/home/mks/klipper/klippy/configfile.py", line 99, in getlists
    note_valid=note_valid)
  File "/home/mks/klipper/klippy/configfile.py", line 33, in _get_wrapper
    % (option, self.section))
configparser.Error: Option 'points' in section 'bed_mesh default' must be specified
webhooks client 281472955360872: New connection
webhooks client 281472955360872: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
Unable to issue reset command on MCU 'mcu'
Unable to issue reset command on MCU 'rpi'
webhooks client 281472955360872: Disconnected
Restarting printer
Start printer at Sat May 13 15:51:33 2023 (1683964293.9 1058.9)
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 134, in _read_config
    config = pconfig.read_main_config()
  File "/home/mks/klipper/klippy/configfile.py", line 281, in read_main_config
    regular_config = self._build_config_wrapper(regular_data, filename)
  File "/home/mks/klipper/klippy/configfile.py", line 268, in _build_config_wrapper
    self._parse_config(data, filename, fileconfig, set())
  File "/home/mks/klipper/klippy/configfile.py", line 260, in _parse_config
    self._parse_config_buffer(buffer, filename, fileconfig)
  File "/home/mks/klipper/klippy/configfile.py", line 220, in _parse_config_buffer
    fileconfig.readfp(sbuffer, filename)
  File "/usr/lib/python3.7/configparser.py", line 762, in readfp
    self.read_file(fp, source=filename)
  File "/usr/lib/python3.7/configparser.py", line 717, in read_file
    self._read(f, source)
  File "/usr/lib/python3.7/configparser.py", line 1110, in _read
    raise e
configparser.ParsingError: Source contains parsing errors: '/home/mks/printer_data/config/printer.cfg'
	[line 19]: 'dd\n'
webhooks client 281472956379600: New connection
webhooks client 281472956379600: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
Starting Klippy...
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
Start printer at Sat May 13 15:52:18 2023 (1683964338.9 25.8)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	M84 X Y E
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 X5 Y5 F3000
	G1 Z1
	G90
	
	G1 X10 Y210
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 220
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 120
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 237
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 2.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	188, 135
points = -16, 135
	188, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,7
mesh_max = 215,217
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4

[bed_mesh default]
version = 1
x_count = 5
y_count = 5
mesh_x_pps = 4
mesh_y_pps = 4
algo = bicubic
tension = 0.3
min_x = 7.0
max_x = 210.0
min_y = 5.0
max_y = 220.0
=======================
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 141, in _read_config
    self.load_object(config, section_config.get_name(), None)
  File "/home/mks/klipper/klippy/klippy.py", line 130, in load_object
    self.objects[section] = init_func(config.getsection(section))
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1244, in load_config
    return BedMesh(config)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 109, in __init__
    self.pmgr = ProfileManager(config, self)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1124, in __init__
    zvals = profile.getlists('points', seps=(',', '\n'), parser=float)
  File "/home/mks/klipper/klippy/configfile.py", line 99, in getlists
    note_valid=note_valid)
  File "/home/mks/klipper/klippy/configfile.py", line 33, in _get_wrapper
    % (option, self.section))
configparser.Error: Option 'points' in section 'bed_mesh default' must be specified
webhooks client 281473571049368: New connection
webhooks client 281473571049368: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
Starting Klippy...
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
Start printer at Sat May 13 15:55:36 2023 (1683964536.9 30.1)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	M84 X Y E
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 X5 Y5 F3000
	G1 Z1
	G90
	
	G1 X10 Y210
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 220
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 120
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 237
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 2.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	188, 135
points = -16, 135
	188, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,7
mesh_max = 215,217
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4

[bed_mesh default]
version = 1
x_count = 5
y_count = 5
mesh_x_pps = 4
mesh_y_pps = 4
algo = bicubic
tension = 0.3
min_x = 7.0
max_x = 210.0
min_y = 5.0
max_y = 220.0
=======================
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 141, in _read_config
    self.load_object(config, section_config.get_name(), None)
  File "/home/mks/klipper/klippy/klippy.py", line 130, in load_object
    self.objects[section] = init_func(config.getsection(section))
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1244, in load_config
    return BedMesh(config)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 109, in __init__
    self.pmgr = ProfileManager(config, self)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1124, in __init__
    zvals = profile.getlists('points', seps=(',', '\n'), parser=float)
  File "/home/mks/klipper/klippy/configfile.py", line 99, in getlists
    note_valid=note_valid)
  File "/home/mks/klipper/klippy/configfile.py", line 33, in _get_wrapper
    % (option, self.section))
configparser.Error: Option 'points' in section 'bed_mesh default' must be specified
webhooks client 281473015131720: New connection
webhooks client 281473015131720: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
Starting Klippy...
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
Start printer at Sat May 13 16:13:33 2023 (1683965613.1 30.3)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	M84 X Y E
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 X5 Y5 F3000
	G1 Z1
	G90
	
	G1 X10 Y210
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 220
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 120
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 237
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 2.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	188, 135
points = -16, 135
	188, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,7
mesh_max = 215,217
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4

[bed_mesh default]
version = 1
x_count = 5
y_count = 5
mesh_x_pps = 4
mesh_y_pps = 4
algo = bicubic
tension = 0.3
min_x = 7.0
max_x = 210.0
min_y = 5.0
max_y = 220.0
=======================
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 141, in _read_config
    self.load_object(config, section_config.get_name(), None)
  File "/home/mks/klipper/klippy/klippy.py", line 130, in load_object
    self.objects[section] = init_func(config.getsection(section))
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1244, in load_config
    return BedMesh(config)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 109, in __init__
    self.pmgr = ProfileManager(config, self)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1124, in __init__
    zvals = profile.getlists('points', seps=(',', '\n'), parser=float)
  File "/home/mks/klipper/klippy/configfile.py", line 99, in getlists
    note_valid=note_valid)
  File "/home/mks/klipper/klippy/configfile.py", line 33, in _get_wrapper
    % (option, self.section))
configparser.Error: Option 'points' in section 'bed_mesh default' must be specified
webhooks client 281472897486128: New connection
webhooks client 281472897486128: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
Starting Klippy...
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
Start printer at Sat May 13 20:17:35 2023 (1683980255.9 29.6)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	M84 X Y E
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F2100
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F2700
	G1 E-2 Z0.2 F2400
	G1 X5 Y5 F3000
	G1 Z1
	G90
	
	G1 X10 Y210
	M106 S0
	M104 S0
	M140 S0
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 220
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 120
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 237
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 2.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	188, 135
points = -16, 135
	188, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,7
mesh_max = 215,217
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4

[bed_mesh default]
version = 1
x_count = 5
y_count = 5
mesh_x_pps = 4
mesh_y_pps = 4
algo = bicubic
tension = 0.3
min_x = 7.0
max_x = 210.0
min_y = 5.0
max_y = 220.0
=======================
Config error
Traceback (most recent call last):
  File "/home/mks/klipper/klippy/klippy.py", line 175, in _connect
    self._read_config()
  File "/home/mks/klipper/klippy/klippy.py", line 141, in _read_config
    self.load_object(config, section_config.get_name(), None)
  File "/home/mks/klipper/klippy/klippy.py", line 130, in load_object
    self.objects[section] = init_func(config.getsection(section))
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1244, in load_config
    return BedMesh(config)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 109, in __init__
    self.pmgr = ProfileManager(config, self)
  File "/home/mks/klipper/klippy/extras/bed_mesh.py", line 1124, in __init__
    zvals = profile.getlists('points', seps=(',', '\n'), parser=float)
  File "/home/mks/klipper/klippy/configfile.py", line 99, in getlists
    note_valid=note_valid)
  File "/home/mks/klipper/klippy/configfile.py", line 33, in _get_wrapper
    % (option, self.section))
configparser.Error: Option 'points' in section 'bed_mesh default' must be specified
webhooks client 281473109343536: New connection
webhooks client 281473109343536: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
webhooks client 281473109343536: Disconnected
webhooks client 281473108864808: New connection
webhooks client 281473108864808: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
Starting Klippy...
Args: ['/home/mks/klipper/klippy/klippy.py', '/home/mks/printer_data/config/printer.cfg', '-I', '/home/mks/printer_data/comms/klippy.serial', '-l', '/home/mks/printer_data/logs/klippy.log', '-a', '/home/mks/printer_data/comms/klippy.sock']
Git version: 'v0.11.0-122-ge6ef48cd'
CPU: 4 core ?
Python: '3.7.3 (default, Oct 31 2022, 14:04:00) \n[GCC 8.3.0]'
Start printer at Sat May 13 20:37:37 2023 (1683981457.8 33.4)
===== Config file =====
[mcu]
serial = /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method = command

[printer]
kinematics = cartesian
max_velocity = 300
max_accel = 8000
max_accel_to_decel = 3000
max_z_velocity = 15
max_z_accel = 100
square_corner_velocity = 3.0

[virtual_sdcard]
path = /home/mks/printer_data/gcodes

[pause_resume]

[display_status]

[idle_timeout]
gcode = 
	RESPOND TYPE=echo MSG="No operations in 10min!"
timeout = 600

[mcu rpi]
serial = /tmp/klipper_host_mcu

[adxl345]
cs_pin = rpi:None
spi_bus = spidev0.0

[verify_heater extruder]
max_error = 60
check_gain_time = 20
hysteresis = 5
heating_gain = 2

[verify_heater heater_bed]
max_error = 60
check_gain_time = 40
hysteresis = 5
heating_gain = 2

[resonance_tester]
accel_chip = adxl345
probe_points = 
	115, 115, 20
accel_per_hz = 50
min_freq = 1
max_freq = 100
max_smoothing = 0.2
hz_per_sec = 0.5

[respond]

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
gcode = 
	TURN_OFF_HEATERS
	CANCEL_PRINT_BASE
	RESPOND TYPE=echo MSG="Cancel Print Success!"
	G91
	G1 E-2 F500
	G1 E-2 Z0.2 F200
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	G90
	G1 X10 Y210 F6000
	M84 X Y E

[gcode_macro START_PRINT]
gcode = 
	M84 E
	G90
	G92 E0
	G1 E-1
	G92 E0
	G28
	BED_MESH_PROFILE LOAD=default
	
	G92 E0
	G1 Z1.0 F3000
	G1 X0.1 Y20 Z0.3 F5000.0
	G1 X0.1 Y100.0 Z0.3 F500.0 E15
	G1 X0.4 Y100.0 Z0.3 F5000.0
	G1 X0.4 Y20 Z0.3 F500.0 E30
	G92 E0
	G1 Z1.0 F3000

[gcode_macro PAUSE]
description = Pause the actual running print
rename_existing = PAUSE_BASE
gcode = 
	RESPOND TYPE=echo MSG="Pause Print!"
	
	{% set x = params.X|default(10) %}
	{% set y = params.Y|default(210) %}
	{% set z = params.Z|default(10)|float %}
	{% set e = params.E|default(1) %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% set lift_z = z|abs %}
	{% if act_z < (max_z - lift_z) %}
	{% set z_safe = lift_z %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	PAUSE_BASE
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E-{e} F500
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G1 Z{z_safe}
	G90
	G1 X{x} Y{y} F6000
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro RESUME]
description = Resume the actual running print
rename_existing = RESUME_BASE
gcode = 
	RESPOND TYPE=echo MSG="RESUME Print!"
	
	{% if True %}
	{% set e = params.E|default(1) %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	G91
	{% if printer.extruder.can_extrude|lower == 'true' %}
	G1 E{e} F400
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	{% endif %}

[gcode_macro END_PRINT]
gcode = 
	G91
	G1 E-2 F500
	G1 E-2 Z0.2 F200
	G1 X5 Y5 F3000
	G1 Z1
	M106 S0
	M104 S0
	M140 S0
	G90
	G1 X10 Y210
	
	M84 X Y E
	RESPOND TYPE=echo MSG="Finish Print!"

[gcode_macro LOAD_FILAMENT]
gcode = 
	G91
	G1 E30 F300
	G1 E10 F150
	G90

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	G91
	G1 E-30 F300
	G90

[gcode_macro LED_ON]
gcode = 
	SET_PIN PIN=my_led VALUE=1

[gcode_macro LED_OFF]
gcode = 
	SET_PIN PIN=my_led VALUE=0

[stepper_x]
step_pin = PD15
dir_pin = PD14
enable_pin = !PC7
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_x: virtual_endstop
homing_retract_dist = 0
position_endstop = -16
position_min = -16
position_max = 225
homing_speed = 90
step_pulse_duration = 0.000004

[tmc2209 stepper_x]
uart_pin = PE3
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 123
stealthchop_threshold = 999999
diag_pin = ^PD10

[stepper_y]
step_pin = PB7
dir_pin = PB6
enable_pin = !PB9
microsteps = 16
rotation_distance = 40
endstop_pin = tmc2209_stepper_y: virtual_endstop
homing_retract_dist = 0
position_endstop = -2
position_min = -2
position_max = 225
homing_speed = 60
step_pulse_duration = 0.000004

[tmc2209 stepper_y]
uart_pin = PE4
run_current = 1.2
uart_address = 3
interpolate = True
driver_sgthrs = 110
stealthchop_threshold = 999999
diag_pin = ^PE0

[stepper_z]
step_pin = PB3
dir_pin = !PD7
enable_pin = !PB5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop
position_max = 253
position_min = -3
homing_speed = 5

[stepper_z1]
step_pin = PA7
dir_pin = !PA6
enable_pin = !PC5
microsteps = 16
rotation_distance = 8
endstop_pin = probe:z_virtual_endstop

[extruder]
max_extrude_only_distance = 100.0
step_pin = PD1
dir_pin = !PD0
enable_pin = !PD4
microsteps = 16
rotation_distance = 4.59
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = PA1
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA4
control = pid
pressure_advance = 0.02
pressure_advance_smooth_time = 0.035
pid_kp = 24.522
pid_ki = 1.397
pid_kd = 107.590
min_temp = 0
max_temp = 300
min_extrude_temp = 150

[tmc2209 extruder]
uart_pin = PE7
run_current = 0.6
uart_address = 3
interpolate = True
stealthchop_threshold = 400

[heater_bed]
heater_pin = PA2
sensor_type = EPCOS 100K B57560G104F
sensor_pin = PA3
control = pid
pid_kp = 54.027
pid_ki = 0.770
pid_kd = 948.182
min_temp = 0
max_temp = 130

[probe]
pin = PD13
x_offset = 27
y_offset = -20
z_offset = 1.000

[filament_switch_sensor my_sensor]
switch_pin = PD11

[safe_z_home]
home_xy_position = 83,130
speed = 100
z_hop = 5
z_hop_speed = 5

[z_tilt]
z_positions = -16, 135
	180, 135
points = -16, 135
	180, 135
speed = 200
horizontal_move_z = 5
retries = 20
retry_tolerance = .005

[bed_mesh]
speed = 200
horizontal_move_z = 5
mesh_min = 11,12
mesh_max = 210,205
probe_count = 5,5
algorithm = bicubic
bicubic_tension = 0.3
mesh_pps = 4,4
move_check_distance = 3

[screws_tilt_adjust]
screw1 = -1, 45
screw1_name = front left screw
screw2 = 168, 45
screw2_name = front right screw
screw3 = 168, 215
screw3_name = rear right screw
screw4 = -1, 215
screw4_name = rear left screw
horizontal_move_z = 5.
speed = 200.
screw_thread = CW-M4

[heater_fan hotend_fan]
pin = PE11

[fan]
pin = PE9

[output_pin my_led]
pin = PC4
pwm = 1
value = 1
cycle_time = 5

[fan_generic extruder_partfan]
pin = PE13

[controller_fan Fan_Board]
pin = PD3
fan_speed = 1.0
idle_timeout = 120
heater = heater_bed, extruder
stepper = stepper_x, stepper_y, stepper_z, stepper_z1

[input_shaper]
damping_ratio_x = 0.1
damping_ratio_y = 0.1
shaper_type_x = 2hump_ei
shaper_freq_x = 43.4
shaper_type_y = 2hump_ei
shaper_freq_y = 43.4
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-1a86_USB_Serial-if00-port0'
webhooks client 281473507523328: New connection
webhooks client 281473507523328: Client info {'program': 'Moonraker', 'version': 'v0.8.0-23-g18f5ff4-dirty'}
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-1a86_USB_Serial-if00-port0'
mcu 'mcu': Unable to open serial port: [Errno 2] could not open port /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0: [Errno 2] No such file or directory: '/dev/serial/by-id/usb-1a86_USB_Serial-if00-port0'
